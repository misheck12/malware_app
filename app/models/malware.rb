class Malware < ApplicationRecord
    has_many :malware_steps, dependent: :destroy

    # For the many-to-many relationship with preventions through the join table
    has_many :malware_preventions, dependent: :destroy
    has_many :preventions, through: :malware_preventions

    # If you have a direct one-to-many relationship with preventions (which seems unlikely based on the schema you provided earlier)
    # has_many :direct_preventions, class_name: 'Prevention', foreign_key: 'malware_id', dependent: :destroy

    has_rich_text :description
  
    validates :name, presence: true
    validates :category, presence: true

    def self.ransackable_attributes(auth_object = nil)
        ["category", "created_at", "date_detected", "id", "impact", "name", "symptoms", "updated_at"]
    end
end
