class Prevention < ApplicationRecord
  belongs_to :malware
  has_many :malware_preventions, dependent: :destroy
  has_many :malwares, through: :malware_preventions
  has_rich_text :description

  validates :name, presence: true
  validates :description, presence: true

  before_create :set_added_on

  def self.ransackable_attributes(auth_object = nil)
    ["added_on", "created_at", "description", "id", "name", "updated_at"]
  end

  def self.ransackable_associations(auth_object = nil)
    ["malware_preventions", "malwares", "rich_text_description"]
  end

  private

  def set_added_on
    self.added_on ||= Date.today
  end
end
